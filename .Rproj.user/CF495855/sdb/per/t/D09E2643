{
    "contents" : "---\ntitle: \"Melate\"\nauthor: \"Pedro Marquez\"\nframework: revealjs\noutput: pdf_document\nhitheme: Tomorrow\njob: Research\nknit: slidify::knit2slides\nmode: selfcontained\nhighlighter: highlight.js\nsubtitle: Lottery Playing Game\next_widgets:\n  rCharts: libraries/nvd3\nwidgets:\n- mathjax\n- quiz\n- bootstrap\n---\n\n<html>\n<body>\n\n<a href=\"http://www.pronosticos.gob.mx/index.php/en/\"><h2 style=\"color:blue\">Melate</h2></a>\n\n<h2 style=\"color:red\">Lottery Game</h2>\n<h4>by</h4>\n<h3>Pedro Marquez</h3>\n\n</body>\n</html>\n\n--- .class #id\n\n<section data-background=\"Aquamarine\">\n\n### Load Libraries, Data and Initialize Game\n\n```{r, echo=F}\n\nlibrary(corrgram)\nlibrary(stats)\nlibrary(graphics)\nlibrary(ggplot2)\nlibrary(moments)\nlibrary(MASS)\nlibrary(vcd)\nlibrary(data.table)\nlibrary(fitdistrplus)\nlibrary(logspline)\nlibrary(rCharts)\nlibrary(dygraphs)\n\nurl <- \"http://www.pronosticos.gob.mx/Historicos/Melate.csv\"\nR <- read.csv(url)\n\n# Random Variables in Data Table\n#vars <- c(\"R1\",\"R2\", \"R3\", \"R4\", \"R5\", \"R6\")\n#R <- subset(M, select=vars)\n\n# Analysis Table of Random Variables\ndt <- data.table(c(0,0,0,0,0,0),c(0,0,0,0,0,0), \n                 c(0,0,0,0,0,0),c(\"\",\"\",\"\",\"\",\"\",\"\"),\n                 c(0,0,0,0,0,0),c(\"\",\"\",\"\",\"\",\"\",\"\"))\nsetnames(dt,c(\"mean\",\"sd\",\"skewness\",\" \",\"kurtosis\",\" \"))\n\n# Suggested Game Table\ngt <- data.table(c(0,0,0,0,0,0),c(0,0,0,0,0,0), \n                    c(0,0,0,0,0,0))\nsetnames(gt,c(\"Game 1\",\"Game 2\",\"Game 3\"))\nR[,c(\"CONCURSO\", \"R1\",\"R2\", \"R3\", \"R4\", \"R5\", \"R6\")]\n```\n\n---\n\n### Visualyzing  Distributions\n\n```{r, echo=FALSE}\nx <- R[,\"R1\"]\nhist(x, main=\"Random Variable R1\", prob=TRUE, col=\"lightblue\")\nlines(density(x, adjust=2), col=\"red\", lwd=2) \n```\n\n--- .class #id \n\n##### Selecting Distribution Type (for R1: Beta or Gamma)\n\n```{r, echo=FALSE}\nx <- R[,\"R1\"]\ndescdist(x, discrete = FALSE)\n```\n\n--- .class #id \n\n### Analysing All Random Variables\n\nSee if they look Gaussian: $\\displaystyle f(x;\\mu,\\lambda) = \\frac{1}{\\sigma \\sqrt{2\\pi}} e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}}$\n\n```{r, echo=F}\ni <- 1\nfor(r in c(\"R1\", \"R2\", \"R3\", \"R4\", \"R5\", \"R6\")){\nx <- R[,r]\n    \n#hist(x, main=r, prob=TRUE, col=\"lightgrey\")\n#lines(density(x, adjust=2), col=\"blue\", lwd=2) \n\nm <- mean(x)\ns <- sd(x)\n\ndt[i,1] <- m\ndt[i,2] <- s\n\nn <- length(x)\n\ndt[i,3] <- sk <- skewness(x)\nif(sk > 0)\n    dt[i,4] <- \"right\"\nelse if (sk < 0)\n    dt[i,4] <- \"left\"\nelse\n    dt[i,4] <- \"symmetrical\"\n\ndt[i,5] <- ku <- kurtosis(x)\nif(ku > 3)\n    dt[i,6] <- \"sharper\"\nelse if (ku < 3)\n    dt[i,6] <- \"flatter\"\nelse\n    dt[i,6] <- \"like normal\"\n\n\ni <- i +1\n\n#descdist(x, discrete = FALSE)\n}\nprint(dt)\n```\n\n--- .class $id\n\n#### Fitting a Distribution (R1)\n\n```{r,echo=F}\n#Beta uses values in [0,1]\nx <- R$R1/(max(R$R1) + 0.0001)\n\nfit <- fitdist(x, \"beta\")\nprint(fit)\nfit$aic\nplot(fit)\n```\n\n--- .class #id\n\n### Density Curve vs. Simulated Distribution\n\n```{r, echo=F}\np <- qplot(x, geom = \"density\",colour = I(\"blue\"))\nstat <- stat_function(aes(x = x, y = ..y..), \n                      fun = dbeta,\n                      lwd=2,\n                      colour=\"red\", n = 100, \n                      args = list(shape1 = fit$estimate[\"shape1\"],\n                                  shape2 = fit$estimate[\"shape2\"]))\np + stat\n\nset.seed( as.integer((as.double(Sys.time())*1000+Sys.getpid()) %% 2^31) )\nn <- round(rbeta(3,shape1 = fit$estimate[\"shape1\"],\n        shape2 = fit$estimate[\"shape2\"])*(max(R$R1) + 0.0001))\n\nfor(i in 1:3) gt[1,i] <- n[i]\n\n```\n\n--- .class #id\n\n## Checking Normality (of R1)\n\n```{r, echo=F}\nnosim <- 1000\n\ncfunc <- function(x, n) {sqrt(n)*(mean(x) - m)/s}\n\ndat <- data.frame(\n    x = c(apply(matrix(rnorm(10*nosim,mean=m,sd=s),nosim), \n                1, cfunc, 10),\n          apply(matrix(rnorm(20*nosim,mean=m,sd=s),nosim), \n                1, cfunc, 20),\n          apply(matrix(rnorm(30*nosim,mean=m,sd=s),nosim), \n                1, cfunc, 30)\n          ),\n    size = factor(rep(c(10, 20, 30), rep(nosim, 3)))\n    )\n\ng <- ggplot(dat, aes(x = x, fill = size)) +\n    geom_histogram(binwidth=0.3, colour = \"black\", \n                   aes(y = ..density..)) +\n    facet_grid(. ~ size) +\n    stat_function(fun = dnorm, size = 2)\nplot(g)\n```\n\n--- .class #id\n\n## Suggested Game\n\n##### (Showing Only Suggested Numbers for R1)\n\n```{r,echo=F}\n\nprint(gt)\n``` \n!['Good Luck!'](http://www.smskhoj.com/wp-content/uploads/2015/10/8871_original.gif)\n\n\n",
    "created" : 1445790641998.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3450552148",
    "id" : "D09E2643",
    "lastKnownWriteTime" : 1445792965,
    "path" : "C:/Users/TOSHIBA/Desktop/Marquez - Coursera/Curso 9 - Developing data Products/prmg/index.Rmd",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_markdown"
}